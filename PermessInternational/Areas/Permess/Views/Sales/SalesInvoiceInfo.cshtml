@model PermessInternational.Areas.Permess.ViewModels.ProductSettingViewModels
<section class="content-header">
    <h1>
        Issue A New Purchase Invoice
        <small>adding new new purchase invoice</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="#" )"><i class="fa fa-dashboard"></i> Home </a></li>
    </ol>
</section>

<!-- Main content -->
<section class="content">
    <div id="dvLoader" class="LoadingDiv" style="display: none;">
        <center>
            <img src="~/Content/img/ajax-loader.gif" alt="Loading" />
        </center>
    </div>
    <div class="row">
        @{
            var name = Convert.ToString(Session["UserName"]);
            var code = DateTime.Now.ToString("mmddfff");
            var si = "4" + "" + code + "" + "3";
        }
        <div class="box" id="sIDocument">
            <div class="box-body">
                <div class="col-md-12 col-sm-12">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="col-form-label">P.I Code</label>
                            <input type="text" id="sICode" name="SICode" readonly="readonly" value="@si" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Issue Date</label>
                            <input type="text" id="issueDate" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Date Remaining</label>
                            <input type="text" id="dateRemaining" readonly="readonly" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Expected Payment Date</label>
                            <input type="text" id="expectedPaymentDate" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Payment Method</label>
                            <select class="form-control" id="paymentMethod">
                                @foreach (var item in Model.PaymentMethods)
                                {
                                    <option value="@item.Id">@item.Name</option>
                                }
                            </select>
                        </div>
                        <div class="form-group" id="hsCodeDiv" style="display:none">
                            <label class="col-form-label">H.S Code</label>
                            <input type="text" id="hSCode" name="HSCode" class="form-control" />
                        </div>
                        <div class="form-group" id="lcStatusDiv" style="display:none">
                            <label class="col-form-label">LC Status</label>
                            <select class="form-control" id="lcStatus">
                                @foreach (var item in Model.YesNoModels)
                                {
                                    <option value="@item.Id">@item.Name</option>
                                }
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="col-form-label">Comission Amount</label>
                            <input type="text" class="form-control" id="commisionAmount" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Buyer</label>
                            <input type="text" id="buyer" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Delivery Address</label>
                            <textarea class="form-control" id="deliveryAddress"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Style</label>
                            <input type="text" class="form-control" id="style" />
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="col-form-label">P.O Number</label>
                            <input type="text" class="form-control" id="pONumber" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">P.I Name</label>
                            <input type="text" id="sIName" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Delivery Status</label>
                            <select class="form-control" id="deliveryStatus">
                                @foreach (var item in Model.Statuses)
                                {
                                    <option value="@item.Id">@item.Name</option>
                                }
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Expected Payment Expired Date</label>
                            <input type="text" id="expectedPaymentExpDate" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Item Num.</label>
                            <input type="text" class="form-control" id="itemNo" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Delivery Type</label>
                            <select class="form-control" id="deliveryType">
                                @foreach (var item in Model.DeliveryTypes)
                                {
                                    <option value="@item.Id">@item.Name</option>
                                }
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Bank</label>
                            <select class="form-control" id="bank">
                                @foreach (var item in Model.Banks)
                                {
                                    <option value="@item.Id">@item.Name</option>
                                }
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Document Status</label>
                            <select class="form-control" id="documentStatus">
                                @foreach (var item in Model.YesNoModels)
                                {
                                    <option value="@item.Id">@item.Name</option>
                                }
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="col-form-label">Buyer Order Reference</label>
                            <textarea class="form-control" id="buyerOrderRef"></textarea>
                        </div>

                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="col-form-label">Isuued By</label>
                            <input type="text" id="issuedBy" value="@name" readonly="readonly" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Delivery Date</label>
                            <input type="text" id="deliveryDate" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Approx Goods Req Date</label>
                            <input type="text" id="goodsReqDate" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Company</label>
                            <select class="form-control" id="companyId">
                                @foreach (var item in Model.Companies)
                                {
                                    <option value="@item.CompanyId">@item.CompanyName</option>
                                }
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Contact Person</label>
                            <input type="text" class="form-control" id="contactPerson" />
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Company Address</label>
                            <textarea class="form-control" id="cadd" readonly="readonly"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Comission Status</label>
                            <select class="form-control" id="commisionStatus">
                                @foreach (var item in Model.Statuses)
                                {
                                    <option value="@item.Id">@item.Name</option>
                                }
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="col-form-label">Revised</label>
                            <select class="form-control" id="revised">
                                @foreach (var item in Model.YesNoModels)
                                {
                                    <option value="@item.Id">@item.Name</option>
                                }
                            </select>
                        </div>

                    </div>
                    <div class="form-group" id="btnOne">
                        <button type="submit" id="btnSubmit" value="submit" class="btn btn-info" style="margin-top:20px;margin-left:33px;">SUBMIT</button>
                    </div>
                    <div class="form-group" id="btnTwo" style="display:none;">
                        <button type="submit" id="btnProduct" value="submit" class="btn btn-info" style="margin-top:20px;margin-left:33px;">Product Preview</button>
                    </div>

                </div>
            </div>
        </div>
        <div class="box" id="sIProduct" style="display:none;">
            <!-- /.box-header -->
            <div class="box-body">
                <div class="col-md-12 col-sm-12">
                    <div class="row">
                        <div id="productHide">
                            <div class="col-md-6">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">P.I Code</label>
                                        <input type="text" id="productSIcode" class="form-control" readonly="readonly" />
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-12">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Article</label>
                                        <select id="articleId" class="form-control">
                                            @foreach (var item in Model.ArticleProductSettings)
                                            {
                                                <option value="@item.ItemId">@item.ItemName</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Alt. Article</label>
                                        <input type="text" id="altArticle" required="required" class="form-control pull-right">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Width</label>
                                        <select id="widthId" class="form-control">
                                            @foreach (var item in Model.WidthProductSettings)
                                            {
                                                <option value="@item.ItemId">@item.ItemName</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Construction</label>
                                        <select id="constructionId" class="form-control">
                                            @foreach (var item in Model.ConstructionProductSettings)
                                            {
                                                <option value="@item.ItemId">@item.ItemName</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Softness</label>
                                        <select id="softnessId" class="form-control">
                                            @foreach (var item in Model.SoftnessProductSettings)
                                            {
                                                <option value="@item.ItemId">@item.ItemName</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Source</label>
                                        <select id="sourceId" class="form-control">
                                            @foreach (var item in Model.SourceProductSettings)
                                            {
                                                <option value="@item.ItemId">@item.ItemName</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Color</label>
                                        <select id="colorId" class="form-control">
                                            @foreach (var item in Model.ColorProductSettings)
                                            {
                                                <option value="@item.ItemId">@item.ItemName</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Length</label>
                                        <select id="lenghtId" class="form-control">
                                            @foreach (var item in Model.Lengths)
                                            {
                                                <option value="@item.Id">@item.Name</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Product</label>
                                        <select id="productId" class="form-control">
                                            @foreach (var item in Model.Products)
                                            {
                                                <option value="@item.ProductId">@item.ProductName</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Order Quantity</label>
                                        <div class="input-group">
                                            <div class="input-group-addon">
                                                <i class="fa fa-try"></i>
                                            </div>
                                            <input type="text" id="orderQuantity" required="required" class="form-control pull-right">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Unit Price</label>
                                        <div class="input-group">
                                            <div class="input-group-addon">
                                                <i class="fa fa-try"></i>
                                            </div>
                                            <input type="text" id="unitPrice" required="required" class="form-control pull-right">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Over Invoice</label>
                                        <div class="input-group">
                                            <div class="input-group-addon">
                                                <i class="fa fa-try"></i>
                                            </div>
                                            <input type="text" id="overInvoice" required="required" class="form-control pull-right">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Net Price</label>
                                        <input type="text" id="netPrice" readonly="readonly" required="required" class="form-control pull-right">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Net Over Invoice</label>
                                        <input type="text" id="netOverInvoice" readonly="readonly" required="required" class="form-control pull-right">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label class="col-form-label">Delivery Quantity</label>
                                        <input type="text" id="deliveryQuantity" required="required" class="form-control pull-right">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <button id="btnNew" type="submit" value="submit" class="btn btn-info" style="margin-top:25px;"><i class="fa fa-plus"></i> New</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="box">
                                <!-- /.box-header -->
                                <div class="box-body">
                                    <table class="table table-bordered">
                                        <thead>
                                            <tr>
                                                <th style="width: 10px">#</th>
                                                <th>Product</th>
                                                <th>Article</th>
                                                <th>Alt Article</th>
                                                <th>Width</th>
                                                <th>Construction</th>
                                                <th>Softness</th>
                                                <th>Source</th>
                                                <th>Color</th>
                                                <th>Lenght Type</th>
                                                <th>Order Quantity</th>
                                                <th>Delivery Quantity</th>
                                                <th>Unit Price</th>
                                                <th>Net Price</th>
                                                <th>Over Invoice</th>
                                                <th>Net Over Invoice</th>
                                                <th style="width: 15px">Delete</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tBody"></tbody>
                                    </table>
                                </div>
                            </div>
                            <!-- /.box -->
                        </div>
                        <div class="col-md-12">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="col-form-label"> Net Price Total</label> 
                                    <div class="input-group">
                                        <div class="input-group-addon">
                                            <i class="fa fa-try"></i>
                                        </div>
                                        <input type="text" readonly="readonly" name="Date" class="form-control pull-right" id="txtGrandTotal2">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="col-form-label"> Net Over Invoice Total</label>
                                    <div class="input-group">
                                        <div class="input-group-addon">
                                            <i class="fa fa-try"></i>
                                        </div>
                                        <input type="text" readonly="readonly" name="Date" class="form-control pull-right" id="txtGrandTotal">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <button id="btnPreview" type="submit" value="submit" class="btn btn-primary">Document Preview</button>
                                </div>
                            </div>
                            @*<div class="col-md-4">
                                    <div class="form-group">
                                        <button id="btnPrint" type="submit" value="submit" class="btn btn-primary">Print & Continue</button>
                                    </div>
                                </div>*@
                            <div class="col-md-4">
                                <div class="form-group">
                                    <button id="btnContinue" type="submit" value="submit" class="btn btn-info">Continue</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

</section>
@section Scripts{
    <script src="~/Content/bower_components/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
    <script>
        $(document).ready(function () {
            $(function () {
                $("#billingDate").datepicker({
                    format: "yyyy-mm-dd"
                });
                $("#issueDate").datepicker({
                    format: "yyyy-mm-dd"
                });
                $("#bankSubDate").datepicker({
                    format: "yyyy-mm-dd"
                });
                $("#shipmentDate").datepicker({
                    format: "yyyy-mm-dd"
                });
                $("#expiraionDate").datepicker({
                    format: "yyyy-mm-dd"
                });
                $("#lCDate").datepicker({
                    format: "yyyy-mm-dd"
                });
                $("#deliveryDate").datepicker({
                    format: "yyyy-mm-dd",
                    //DateCount();
                });
                $("#goodsReqDate").datepicker({
                    format: "yyyy-mm-dd",
                    //DateCount();
                });
                $("#expectedPaymentDate").datepicker({
                    format: "yyyy-mm-dd",
                    //DateCount();
                });
                $("#expectedPaymentExpDate").datepicker({
                    format: "yyyy-mm-dd",
                    //DateCount();
                });
            });
            $("#btnPreview").click(function () {
                $("#sIDocument").show("slow");
                $("#sIProduct").hide("slow");
            });
            $("#btnProduct").click(function () {
                $("#sIDocument").hide("slow");
                $("#sIProduct").show("slow");
            });
            $("#paymentMethod").change(function () {
                var pay = $("#paymentMethod").val();
                //alert(pay);
                if (pay == 3) {
                    $("#lcStatusDiv").show();
                    $("#hsCodeDiv").show();
                }
                else {
                    $("#lcStatusDiv").hide();
                    $("#hsCodeDiv").hide();
                }
            });
            $("#deliveryDate").change(function () {
                DateCount();
            });
            function DateCount() {
                var issue = $("#issueDate").datepicker("getDate");
                var delevery = $("#deliveryDate").datepicker("getDate");
                var diff = new Date(delevery - issue);
                var remaining = diff / (1000 * 60 * 60 * 24);
                //alert(remaining);
                $("#dateRemaining").val(remaining);
            };
            $("#companyId").change(function () {
                var company = $("#companyId").val();
                //alert(company);
                $('#dvLoader').show();
                $.ajax({
                    url: "/PermessData/CompanyById",
                    type: "POST",
                    data: JSON.stringify({
                        "id": company
                    }),
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        console.log(data);
                        $("#cadd").val(data.CompanyAddress);
                        $("#deliveryAddress").val(data.CompanyAddress);
                        $("#contactPerson").val(data.ContactPerson);
                        $("#buyer").val(data.Buyer);
                        $('#dvLoader').hide();

                    }
                });

            });
            $("#btnContinue").click(function () {
                var sICode = $("#sICode").val();
                var issueDate = $("#issueDate").val();
                var issuedBy = $("#issuedBy").val();
                var sIName = $("#sIName").val();
                var pONumber = $("#pONumber").val();
                var style = $("#style").val();
                var deliveryStatus = $("#deliveryStatus").val();
                var deliveryDate = $("#deliveryDate").val();
                var goodsReqDate = $("#goodsReqDate").val();
                var expectedPaymentDate = $("#expectedPaymentDate").val();
                var expectedPaymentExpDate = $("#expectedPaymentExpDate").val();
                var itemNo = $("#itemNo").val();
                var deliveryType = $("#deliveryType").val();
                var buyer = $("#buyer").val();
                var paymentMethod = $("#paymentMethod").val();
                var bank = $("#bank").val();
                var companyId = $("#companyId").val();
                var documentStatus = $("#documentStatus").val();
                var deliveryAddress = $("#deliveryAddress").val();
                var contactPerson = $("#contactPerson").val();
                var revised = $("#revised").val();
                var approvedStatus = $("#approvedStatus").val();
                var commisionStatus = $("#commisionStatus").val();
                var commisionAmount = $("#commisionAmount").val();
                var lCStatus = $("#lCStatus").val();
                var hSCode = $("#hSCode").val();
                var buyerOrderRef = $("#buyerOrderRef").val();
                var orderDetails = $("#orderDetails").val();
                var description = $("#description").val();
                //alert(company);
                $('#dvLoader').show();
                $.ajax({
                    url: "/Sales/SalesInvoiceInfo",
                    type: "POST",
                    data: JSON.stringify({
                        "SICode": sICode,
                        "IssueDate": issueDate,
                        "IssuedBy": issuedBy,
                        "SIName": sIName,
                        "PONumber": pONumber,
                        "Style": style,
                        "DeliveryStatus": deliveryStatus,
                        "DeliveryDate": deliveryDate,
                        "GoodsReqDate": goodsReqDate,
                        "ExpectedPaymentDate": expectedPaymentDate,
                        "ExpectedPaymentExpDate": expectedPaymentExpDate,
                        "ItemNo": itemNo,
                        "DeliveryType": deliveryType,
                        "Buyer": buyer,
                        "PaymentMethod": paymentMethod,
                        "bank": bank,
                        "CompanyId": companyId,
                        "DocumentStatus": documentStatus,
                        "DeliveryAddress": deliveryAddress,
                        "ContactPerson": contactPerson,
                        "Revised": revised,
                        "ApprovedStatus": approvedStatus,
                        "CommisionStatus": commisionStatus,
                        "CommisionAmount": commisionAmount,
                        "LCStatus": lCStatus,
                        "HSCode": hSCode,
                        "BuyerOrderRef": buyerOrderRef,
                        "BuyerOrderRef": buyerOrderRef,
                        "OrderDetails": orderDetails,
                        "Description": description,
                    }),
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                    success: function (json) {
                        if (json.isRedirect) {
                            window.location.href = json.redirectUrl;
                        }
                        $('#dvLoader').hide();
                    }
                });

            });
            $("#btnNew").click(function () {
                var productSIcode = $("#productSIcode").val();
                var productId = $("#productId").val();
                var articleId = $("#articleId").val();
                var altArticle = $("#altArticle").val();
                var widthId = $("#widthId").val();
                var constructionId = $("#constructionId").val();
                var softnessId = $("#softnessId").val();
                var sourceId = $("#sourceId").val();
                var colorId = $("#colorId").val();
                var lenghtId = $("#lenghtId").val();
                var orderQuantity = $("#orderQuantity").val();
                var deliveryQuantity = $("#deliveryQuantity").val();
                var unitPrice = $("#unitPrice").val();
                var overInvoice = $("#overInvoice").val();
                $('#dvLoader').show();
                $.ajax({
                    url: "/Sales/SalesProductDetails",
                    type: "POST",
                    data: JSON.stringify({
                        "SICode": productSIcode,
                        "ProductId": productId,
                        "ArticleId": articleId,
                        "AltArticle": altArticle,
                        "WidthId": widthId,
                        "ConstructionId": constructionId,
                        "SoftnessId": softnessId,
                        "SourceId": sourceId,
                        "ColorId": colorId,
                        "LenghtId": lenghtId,
                        "OrderQuantity": orderQuantity,
                        "DeliveryQuantity": deliveryQuantity,
                        "UnitPrice": unitPrice,
                        "OverInvoice": overInvoice,
                    }),
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                    success: function () {
                        LoadSessionData(productSIcode);
                        Clearproduct();
                        $('#dvLoader').hide();
                        //$('#productHide').hide();
                    }
                });
            });
            $("#unitPrice").keyup(function () {
                LoadNetPrice();
            });
            $("#overInvoice").keyup(function () {
                LoadnetOverInvoice();
            });
            $("#btnSubmit").click(function () {
                var sICode = $("#sICode").val();
                $("#productSIcode").val(sICode);
                $("#sIDocument").hide("slow");
                $("#sIProduct").show("slow");

            });

        });

        function Clear() {
            $("#productId").val('');
            $("#articleId").val('');
            $("#altArticle").val('');
            $("#widthId").val('');
            $("#constructionId").val('');
            $("#softnessId").val('');
            $("#sourceId").val('');
            $("#colorId").val('');
            $("#lenghtId").val('');
            $("#orderQuantity").val('');
            $("#deliveryQuantity").val('');
            $("#unitPrice").val('');
            $("#overInvoice").val('');
            $("#netPrice").val('');
            $("#netOverInvoice").val('');
        };
        function Clearproduct() {
            $("#productId").val('');
            $("#articleId").val('');
            $("#altArticle").val('');
            $("#widthId").val('');
            $("#constructionId").val('');
            $("#softnessId").val('');
            $("#sourceId").val('');
            $("#colorId").val('');
            $("#lenghtId").val();
            $("#orderQuantity").val('');
            $("#deliveryQuantity").val('');
            $("#unitPrice").val('');
            $("#overInvoice").val('');
        };
        function LoadNetPrice() {
            var netPrice = $("#unitPrice").val();
            var quantity = $("#orderQuantity").val();
            var price = netPrice * quantity;
            $("#netPrice").val(price);
        };
        function LoadnetOverInvoice() {
            var over = $("#overInvoice").val();
            var net = $("#netPrice").val();
            var value = over * net;
            $("#netOverInvoice").val(value);
        };
        function LoadSessionData(codes) {
            //var siCode = $("#productSIcode").val();
            $.ajax({
                url: "/Sales/GetSalesProductDetails?code=" + codes,
                type: "GET",
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    console.log(data);
                    var invoice = data.SISessionproductDetails;
                    var tr = "";
                    var total_over = 0;
                    var total_unit = 0;
                    var sl = 0;
                    invoice.forEach(function (invoice) {
                        sl++;
                        tr += '<tr>';
                        tr += '<td>' + sl + '</td>';
                        tr += '<td>' + invoice.ProductName + '</td>';
                        tr += '<td>' + invoice.Article + '</td>';
                        tr += '<td>' + invoice.AltArticle + '</td>';
                        tr += '<td>' + invoice.Width + '</td>';
                        tr += '<td>' + invoice.Construction + '</td>';
                        tr += '<td>' + invoice.Softness + '</td>';
                        tr += '<td>' + invoice.Source + '</td>';
                        tr += '<td>' + invoice.Color + '</td>';
                        tr += '<td>' + invoice.Lenght + '</td>';
                        tr += '<td>' + invoice.OrderQuantity + '</td>';
                        tr += '<td>' + invoice.DeliveryQuantity + '</td>';
                        tr += '<td>' + invoice.UnitPrice + '</td>';
                        tr += '<td>' + invoice.Netprice + '</td>';
                        tr += '<td>' + invoice.OverInvoice + '</td>';
                        tr += '<td>' + invoice.NetOverInvoice + '</td>';
                        tr += '<td><a class="ClearById" href="' + invoice.SIProductDetId + '"><i class="fa fa-trash"></i></a></td>';
                        tr += '</tr>';
                        total_over += invoice.NetOverInvoice;
                        total_unit += invoice.Netprice;
                    });
                    $("#txtGrandTotal").val(total_over);
                    $("#txtGrandTotal2").val(total_unit);
                    $("#tBody").html(tr);
                    $('#dvLoader').hide();
                    //Clear();
                }
            });
        }
        $(document).on('click', '.ClearById', function (event) {
            event.preventDefault();
            var product_id = $(this).attr('href');
            $('#dvLoader').show();
            var siCode = $("#productSIcode").val();
            var result = confirm("Are you sure you want to delete this Record?");
            if (result) {
                $.ajax({
                    url: "/sales/ClearSalesProductById?id=" + product_id,
                    type: "POST",
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                    success: function () {
                        LoadSessionData(siCode);
                        $('#dvLoader').hide();

                    }
                });
            }
            $('#dvLoader').hide();
        });

    </script>
}